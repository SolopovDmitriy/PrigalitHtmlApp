<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤</title>
  <style>
    :root{
      --bg1:#6f8fb9;
      --bg2:#3459b6;
      --stroke:rgba(255,255,255,.14);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.72);
      --danger:#ff6a5f;
      --success:#4ade80;
      --shadow:0 30px 90px rgba(0,0,0,.25);
    }
    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(255,255,255,.22), transparent 50%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      color:var(--text);
      min-height:100vh;
      padding:22px;
    }

    .frame{
      width:min(1500px, 100%);
      margin:0 auto;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:22px;
      box-shadow:var(--shadow);
      padding:18px;
    }

    .content{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:22px;
      padding:26px;
      max-height: 640px;
      overflow:auto;
    }

    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-bottom:18px;
    }

    h1{
      font-size:44px;
      font-weight:800;
      letter-spacing:.2px;
      margin:0;
      text-shadow:0 2px 14px rgba(0,0,0,.18);
    }

    .close{
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.08);
      color:rgba(255,255,255,.90);
      width:44px;
      height:44px;
      border-radius:14px;
      cursor:pointer;
      font-size:22px;
      display:grid;
      place-items:center;
    }
    .close:hover{ background:rgba(255,255,255,.12); }

    .section{
      margin-bottom:28px;
    }

    h2{
      font-size:24px;
      font-weight:800;
      margin:0 0 16px;
      padding-bottom:10px;
      border-bottom:1px solid rgba(255,255,255,.12);
    }

    .param-card{
      padding:20px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      margin-bottom:16px;
    }

    .label{
      font-size:18px;
      font-weight:700;
      margin-bottom:12px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .req{ color:var(--danger); font-weight:900; }

    .input, .select{
      width:100%;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.08);
      color:var(--text);
      border-radius:12px;
      padding:14px 16px;
      font-size:18px;
      outline:none;
    }
    .input::placeholder{ color:rgba(255,255,255,.55); }

    .helper{
      font-size:14px;
      color:rgba(255,255,255,.70);
      margin-top:8px;
      line-height:1.35;
    }

    .range-inputs{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:16px;
      margin-top:12px;
    }

    .range-value{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .range-label{
      font-size:15px;
      font-weight:700;
      min-width:80px;
    }

    .visual-range{
      margin-top:16px;
      padding:16px;
      border-radius:10px;
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
    }

    .range-bar{
      height:40px;
      background:linear-gradient(90deg, 
        var(--danger) 0%, 
        var(--danger) 20%, 
        var(--success) 40%, 
        var(--success) 60%, 
        var(--danger) 80%, 
        var(--danger) 100%);
      border-radius:8px;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 12px;
      font-weight:800;
      font-size:14px;
    }

    .range-marker{
      position:absolute;
      width:3px;
      height:100%;
      background:white;
      box-shadow:0 0 10px rgba(0,0,0,.4);
    }

    .toggle-wrapper{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-top:12px;
    }

    .toggle-label{
      font-size:16px;
      font-weight:600;
    }

    .toggle-switch{
      position:relative;
      width:60px;
      height:32px;
      flex-shrink:0;
    }

    .toggle-switch input{
      opacity:0;
      width:0;
      height:0;
    }

    .toggle-slider{
      position:absolute;
      cursor:pointer;
      inset:0;
      background:rgba(255,255,255,.15);
      border-radius:32px;
      transition:.3s;
    }

    .toggle-slider:before{
      position:absolute;
      content:"";
      height:24px;
      width:24px;
      left:4px;
      bottom:4px;
      background:white;
      border-radius:50%;
      transition:.3s;
    }

    input:checked + .toggle-slider{
      background:#4a86ff;
    }

    input:checked + .toggle-slider:before{
      transform:translateX(28px);
    }

    .disabled-overlay{
      opacity:.4;
      pointer-events:none;
    }

    .footer{
      display:flex;
      justify-content:flex-end;
      gap:12px;
      margin-top:18px;
      padding-top:16px;
      border-top:1px solid rgba(255,255,255,.12);
    }

    .btn{
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.08);
      color:rgba(255,255,255,.92);
      padding:14px 18px;
      border-radius:14px;
      cursor:pointer;
      font-weight:800;
      font-size:16px;
      min-width:140px;
    }
    .btn:hover{ background:rgba(255,255,255,.12); }

    .btn-primary{
      border-color:rgba(255,255,255,.22);
      background:linear-gradient(180deg, rgba(74,134,255,.65), rgba(60,120,255,.40));
      box-shadow:0 10px 22px rgba(0,0,0,.18);
    }
    .btn-primary:hover{ filter:brightness(1.05); }

    @media (max-width: 980px){
      .range-inputs{ grid-template-columns:1fr; }
      h1{ font-size:34px; }
    }
  </style>
</head>

<body>
  <div class="frame">
    <div class="content">
      <div class="header">
        <h1>–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤</h1>
        <button class="close" type="button" aria-label="–ó–∞–∫—Ä–∏—Ç–∏" onclick="closeForm()">√ó</button>
      </div>

      <form id="monitoringForm" novalidate>
        
        <!-- –°–µ–∫—Ü—ñ—è 1: –ê—Ä—Ç–µ—Ä—ñ–∞–ª—å–Ω–∏–π —Ç–∏—Å–∫ -->
        <div class="section">
          <h2>ü©∫ –ê—Ä—Ç–µ—Ä—ñ–∞–ª—å–Ω–∏–π —Ç–∏—Å–∫</h2>
          <div class="param-card">
            <div class="label"><span class="req">*</span>–î–æ–ø—É—Å—Ç–∏–º–∞ –≤–µ—Ä—Ö–Ω—è –º–µ–∂–∞ —Å–∏—Å—Ç–æ–ª—ñ—á–Ω–æ–≥–æ —Ç–∏—Å–∫—É</div>
            <input id="maxSystolic" type="number" class="input" placeholder="–Ω–∞–ø—Ä. 140" min="100" max="200" step="1" required>
            <div class="helper">–ù–æ—Ä–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è: 110-130 –º–º —Ä—Ç. —Å—Ç. –ü—Ä–∏ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—ñ –Ω–∞–¥—ñ–π–¥–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è.</div>
          </div>
        </div>

        <!-- –°–µ–∫—Ü—ñ—è 2: pH —Å–µ—á—ñ -->
        <div class="section">
          <h2>üß™ –†—ñ–≤–µ–Ω—å pH —Å–µ—á—ñ</h2>
          
          <div class="param-card">
            <div class="toggle-wrapper">
              <div class="toggle-label">–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É pH –≤—Ä—É—á–Ω—É</div>
              <label class="toggle-switch">
                <input type="checkbox" id="manualPhRange" onchange="togglePhRange()">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="helper">–£–≤—ñ–º–∫–Ω—ñ—Ç—å –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É pH</div>
          </div>

          <div id="phRangeSection" class="param-card disabled-overlay">
            <div class="label"><span class="req">*</span>–¶—ñ–ª—å–æ–≤–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω pH</div>
            
            <div class="range-inputs">
              <div class="range-value">
                <span class="range-label">–ù–∏–∂–Ω—è –º–µ–∂–∞:</span>
                <input id="phMin" type="number" class="input" placeholder="6.2" min="4.5" max="8.5" step="0.1" value="6.2">
              </div>
              <div class="range-value">
                <span class="range-label">–í–µ—Ä—Ö–Ω—è –º–µ–∂–∞:</span>
                <input id="phMax" type="number" class="input" placeholder="6.8" min="4.5" max="8.5" step="0.1" value="6.8">
              </div>
            </div>

            <div class="visual-range">
              <div class="range-bar">
                <span>4.5</span>
                <div id="minMarker" class="range-marker" style="left:30%"></div>
                <div id="maxMarker" class="range-marker" style="left:50%"></div>
                <span>8.5</span>
              </div>
              <div class="helper" style="margin-top:8px; text-align:center;">
                –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–ª—è —É—Ä–∞—Ç–Ω–∏—Ö –∫–∞–º–µ–Ω—ñ–≤: 6.2-6.8
              </div>
            </div>
          </div>

          <div class="param-card">
            <div class="toggle-wrapper">
              <div class="toggle-label">–ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è pH</div>
              <label class="toggle-switch">
                <input type="checkbox" id="phReminder" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="helper">–û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ —Ä–µ–≥—É–ª—è—Ä–Ω–µ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è pH —Å–µ—á—ñ</div>
          </div>
        </div>

        <div class="footer">
          <button class="btn" type="button" onclick="closeForm()">–í—ñ–¥–º—ñ–Ω–∏—Ç–∏</button>
          <button class="btn btn-primary" type="submit">–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById('monitoringForm');
    const phRangeSection = document.getElementById('phRangeSection');
    const manualPhRange = document.getElementById('manualPhRange');
    const phMin = document.getElementById('phMin');
    const phMax = document.getElementById('phMax');
    const minMarker = document.getElementById('minMarker');
    const maxMarker = document.getElementById('maxMarker');

    function closeForm() {
      window.history.back();
    }

    // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ä—É—á–Ω–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É pH
    function togglePhRange() {
      if (manualPhRange.checked) {
        phRangeSection.classList.remove('disabled-overlay');
        phMin.required = true;
        phMax.required = true;
      } else {
        phRangeSection.classList.add('disabled-overlay');
        phMin.required = false;
        phMax.required = false;
      }
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–∑—É–∞–ª—å–Ω–∏—Ö –º–∞—Ä–∫–µ—Ä—ñ–≤
    function updatePhMarkers() {
      const min = parseFloat(phMin.value) || 6.2;
      const max = parseFloat(phMax.value) || 6.8;
      
      // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∑–Ω–∞—á–µ–Ω—å pH –≤ –≤—ñ–¥—Å–æ—Ç–∫–∏ –ø–æ–∑–∏—Ü—ñ—ó (4.5-8.5 = 0-100%)
      const minPercent = ((min - 4.5) / 4.0) * 100;
      const maxPercent = ((max - 4.5) / 4.0) * 100;
      
      minMarker.style.left = `${minPercent}%`;
      maxMarker.style.left = `${maxPercent}%`;
    }

    phMin.addEventListener('input', updatePhMarkers);
    phMax.addEventListener('input', updatePhMarkers);

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
    function loadSettings() {
      const data = localStorage.getItem('monitoring_settings');
      if (data) {
        const settings = JSON.parse(data);
        
        document.getElementById('maxSystolic').value = settings.bloodPressure.maxSystolic || 140;
        
        if (settings.ph.manualRange) {
          manualPhRange.checked = true;
          togglePhRange();
          phMin.value = settings.ph.min || 6.2;
          phMax.value = settings.ph.max || 6.8;
          updatePhMarkers();
        }
        
        document.getElementById('phReminder').checked = settings.ph.reminder !== false;
      }
    }

    // –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const minVal = parseFloat(phMin.value);
      const maxVal = parseFloat(phMax.value);

      // –í–∞–ª—ñ–¥–∞—Ü—ñ—è pH –¥—ñ–∞–ø–∞–∑–æ–Ω—É
      if (manualPhRange.checked && minVal >= maxVal) {
        alert('–ù–∏–∂–Ω—è –º–µ–∂–∞ pH –º–∞—î –±—É—Ç–∏ –º–µ–Ω—à–µ –≤–µ—Ä—Ö–Ω—å–æ—ó –º–µ–∂—ñ');
        return;
      }

      const monitoringData = {
        bloodPressure: {
          maxSystolic: parseInt(document.getElementById('maxSystolic').value)
        },
        ph: {
          manualRange: manualPhRange.checked,
          min: manualPhRange.checked ? minVal : 6.2,
          max: manualPhRange.checked ? maxVal : 6.8,
          reminder: document.getElementById('phReminder').checked
        },
        updatedAt: new Date().toISOString()
      };

      localStorage.setItem('monitoring_settings', JSON.stringify(monitoringData));

      console.log('Monitoring settings saved:', monitoringData);
      alert('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —É—Å–ø—ñ—à–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!');
      
      closeForm();
    });

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    loadSettings();
    updatePhMarkers();
    window.togglePhRange = togglePhRange;
  </script>
</body>
</html>